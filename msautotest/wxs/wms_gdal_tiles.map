#
# Test WMS based on a GDAL tile source
#
# REQUIRES: SUPPORTS=WMS
#

# RUN_PARMS: wms_gdal_tiles.xml [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&REQUEST=GetCapabilities" > [RESULT_DEVERSION]
# RUN_PARMS: wms_gdal_tiles.png [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&CRS=EPSG%3A4326&BBOX=35.18749999863387,-141.0000000021858,90.81250000136613,-51.99999999781419&WIDTH=560&HEIGHT=350&LAYERS=road&STYLES=&FORMAT=image%2Fpng&BGCOLOR=0xFFFFFF&TRANSPARENT=FALSE&QUERY_LAYERS=road&I=483&J=291&FEATURE_COUNT=5" > [RESULT_DEVERSION]

MAP

NAME WMS_GDAL_TILE_TEST
SHAPEPATH ./data

# CONFIG "MS_ERRORFILE" "stderr"
# DEBUG 5

WEB
  METADATA
    "wms_onlineresource" "http://localhost/path/to/ows?"
    "wms_enable_request" "*"
    "wms_srs" "EPSG:3857 EPSG:4326"
    "wms_title" "Test tiles from GDAL"
  END
END

PROJECTION
  "init=epsg:3857"
END

EXTENT -20026376.39 -20048966.10 20026376.39 20048966.10

LAYER
    NAME 'osm'
    TYPE RASTER
    METADATA
       "wms_title" "Tiles"
    END
    # DEBUG 5
    EXTENT -20026376.39 -20048966.10 20026376.39 20048966.10
    PROCESSING "OVERSAMPLE_RATIO=1"  # the default is 2.5
    PROCESSING "LOAD_FULL_RES_IMAGE=NO"
    PROCESSING "RESAMPLE=NEAREST"
    # See https://gdal.org/drivers/raster/wms.html#tms
    DATA 'osm_tiles.xml' # if SHAPEPATH is used then the path here is relative to SHAPEPATH and not the Mapfile
END

END # Map File
